# Apache httpd policy
# Format: p, subject, object, action, class, effect

# Allow httpd to read and write web content
p, httpd_t, /var/www/html/*, read, file, allow
p, httpd_t, /var/www/html/*, write, file, allow
p, httpd_t, /var/www/html/*, getattr, file, allow

# Allow httpd to write to log files
p, httpd_t, /var/log/httpd/*, write, file, allow
p, httpd_t, /var/log/httpd/*, append, file, allow
p, httpd_t, /var/log/httpd/*, create, file, allow

# Allow httpd to read configuration files
p, httpd_t, /etc/httpd/*, read, file, allow
p, httpd_t, /etc/httpd/*, getattr, file, allow

# Allow httpd to read system libraries
p, httpd_t, /lib64/*, read, file, allow
p, httpd_t, /usr/lib64/*, read, file, allow

# Deny httpd from writing to system binaries
p, httpd_t, /usr/bin/*, write, file, deny
p, httpd_t, /usr/sbin/*, write, file, deny

# Network permissions
p, httpd_t, tcp_socket, bind, tcp_socket, allow
p, httpd_t, tcp_socket, listen, tcp_socket, allow
p, httpd_t, tcp_socket, accept, tcp_socket, allow
