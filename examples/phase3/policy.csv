# Boolean definitions using g2 with special encoding
# Format: g2, <boolean_name>, bool:<default_value>
g2, httpd_enable_homedirs, bool:false
g2, httpd_can_network_connect, bool:true

# Basic web server rules
p, httpd, /var/www/html/*, read, file, allow
p, httpd, /var/log/httpd/*, write, file, allow
p, httpd, /var/run/httpd.pid, create, file, allow

# Allow httpd to listen on common ports
p, httpd, 80, name_bind, tcp_socket, allow
p, httpd, 443, name_bind, tcp_socket, allow

# Conditional rule based on boolean (condition encoded in object using ?cond=)
p, httpd, /home/*?cond=httpd_enable_homedirs, read, dir, allow

# Domain transition for CGI scripts using p2 with action="transition"
# Format: p2, <source_type>, <target_type>, transition, <class>, <new_type>
p2, httpd, httpd_sys_script_exec_t, transition, process, httpd_sys_script_t

# Rules for the transitioned domain
p, httpd_sys_script_t, /bin/sh, execute, file, allow
p, httpd_sys_script_t, /var/tmp/*, rw, file, allow
