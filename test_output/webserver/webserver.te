########################################
# SELinux Policy Module: webserver
# Version: 1.0.0
# Generated by PML-to-SELinux Compiler
########################################

policy_module(webserver, 1.0.0)

########################################
# Type Declarations
########################################

type httpd_t;
type webserver_etc_httpd_conf_t;
type webserver_etc_httpd_t;
type webserver_etc_pki_tls_certs_t;
type webserver_etc_pki_tls_private_t;
type webserver_home_t;
type webserver_lib64_t;
type webserver_usr_lib64_t;
type webserver_var_log_httpd_t;
type webserver_var_run_httpd_t;
type webserver_var_www_cgi_bin_t;
type webserver_var_www_html_t;
type webserver_var_www_t;

########################################
# Allow Rules
########################################

# Rules for httpd_t
allow httpd_t httpd_t:file { fork sigchld };
allow httpd_t httpd_t:process signal;
allow httpd_t tcp_socket_t:file { append create getattr open read write };
allow httpd_t tcp_socket_t:tcp_socket { accept bind listen };
allow httpd_t udp_socket_t:file { append create getattr open read write };
allow httpd_t udp_socket_t:tcp_socket connect;
allow httpd_t webserver_etc_httpd_conf_t:file { getattr open read };
allow httpd_t webserver_etc_httpd_t:dir { getattr search };
allow httpd_t webserver_etc_httpd_t:file { getattr open read };
allow httpd_t webserver_etc_pki_tls_certs_t:file { getattr open read };
allow httpd_t webserver_etc_pki_tls_private_t:file { getattr open read };
allow httpd_t webserver_lib64_t:file { getattr open read };
allow httpd_t webserver_usr_lib64_t:file { getattr open read };
allow httpd_t webserver_var_log_httpd_t:dir { getattr search };
allow httpd_t webserver_var_log_httpd_t:file { append create open write };
allow httpd_t webserver_var_run_httpd_t:file { append create getattr open read write };
allow httpd_t webserver_var_www_cgi_bin_t:file { execute execute_no_trans getattr open read };
allow httpd_t webserver_var_www_html_t:dir { getattr search };
allow httpd_t webserver_var_www_html_t:file { getattr open read };
allow httpd_t webserver_var_www_t:dir { getattr search };

########################################
# Deny Rules (neverallow)
########################################

neverallow httpd_t webserver_etc_httpd_t:file { append open write };
neverallow httpd_t webserver_home_t:file { append getattr open read write };
neverallow httpd_t webserver_var_www_html_t:file { execute execute_no_trans getattr open read };

